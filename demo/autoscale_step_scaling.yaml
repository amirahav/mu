<%
  $region = MU.curRegion unless $region
%>

appname: testme
region: <%= $region %>
parameters:
  - name: appname
    default: autoscale
  - name: vpc
    cloudtype: AWS::EC2::VPC::Id
    default: <%= MU.myVPC %>
  - name: nat_ssh_user
    default: ubuntu

loadbalancers:
- name: lb
  dns_sync_wait: false
  private: true
  alarms:
  - name: unhealthy-hosts
    metric_name: UnHealthyHostCount
    statistic: Average
    period: 60
    evaluation_periods: 1
    threshold: 0
    comparison_operator: GreaterThanThreshold
    enable_notifications: true
  - name: connection-errors
    metric_name: BackendConnectionErrors
    statistic: Average
    period: 60
    evaluation_periods: 1
    unit: Count
    threshold: 0
    comparison_operator: GreaterThanThreshold
    enable_notifications: true
  vpc:
    vpc_id: vpc-8bf71aee
    subnets:
    - subnet_id: subnet-9c3751a6
    - subnet_id: subnet-4bf3f73f
    - subnet_id: subnet-3ad59412
    - subnet_id: subnet-901332d6
  cross_zone_unstickiness: true
  idle_timeout: 240
  healthcheck:
    target: HTTP:80/heartbeat.html
    unhealthy-threshold: 2
    healthy-threshold: 3
  listeners:
  - lb-port: 80
    lb-protocol: HTTP
    instance-port: 80
    instance-protocol: HTTP
  ingress_rules:
  - port: 80
    hosts:
    - 0.0.0.0/0
