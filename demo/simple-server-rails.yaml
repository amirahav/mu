<%
  $azs = listAZs
  $azs.delete $azskip if $azskip
%>
---
  appname: demo
  servers:
    -
      name: rails
      ssh_user: ubuntu
      platform: ubuntu
      storage:
        -
          size: 15
      ami-id: ami-50e3c738
      skipinitialupdates: true
      size: t2.micro
      run_list:
      - "recipe[demo::rails]"
      associate_public_ip: true
      static_ip:
        assign_ip: true
      vpc:
        vpc_name: vpc
        subnet_name: Subnet0Public
      ingress_rules:
        -
          port: 80
          hosts:
            - 0.0.0.0/0
        -
          port: 443
          hosts:
            - 0.0.0.0/0
      dependencies:
        -
          name: fss
          type: database
  vpcs:
  - name: vpc
    route-tables:
    - name: internet
      routes:
      - destination_network: 0.0.0.0/0
        gateway: #INTERNET
    subnets:
  <% $azs.each.with_index do |az, i| %>
    - name: Subnet<%= i %>Public
      ip_block: 10.0.<%= i %>.0/24
      availability-zone: <%= az %>
      route-table: internet
  <% end %>
  databases:
    -
      name: fss
      engine: mysql
      size: db.t1.micro
      storage: 5
      port: 3306
      vpc:
        vpc_name: vpc
        subnets:
        <% (1..$azs.size).each do |i| %>
          - subnet_name: Subnet<%= i-1 %>Public
        <% end %>
  admins:
    -
      name: Zach Rowe
      email: zachary.rowe@eglobaltech.com
